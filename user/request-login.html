<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ajukan Nomor Login - PerpustakaanKu</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <div class="page">
      <header>
        <div class="container nav">
          <a class="logo" href="./index.html">Perpustakaan Politeknik Negeri Medan</a>
          <div class="search-bar">
            
          <a class="btn btn-outline" href="./login.html">Kembali ke Login</a>
        </div>
      </header>

      <main class="container" style="flex: 1; padding: 48px 0;">
        <section class="card form-card" style="max-width: 640px;">
          <div class="notice-card" style="margin-bottom: 24px;">
            <div>
              <p class="notice-title">Ajukan Nomor Login</p>
              <p class="muted">
                Isi formulir berikut untuk meminta nomor login baru. Admin akan memverifikasi data dan mengirimkan nomor login melalui
                email kampus Anda.
              </p>
            </div>
          </div>
          <form action="../admin/insert_login_request.php" method="POST" class="auth-form">
            <div>
              <label for="namaLengkap">Nama Lengkap</label>
              <input id="namaLengkap" name="nama" type="text" placeholder="contoh: Budi Santoso" required />
            </div>
            <div>
              <label for="nim">NIM</label>
              <input id="nim" name="nim" type="text" placeholder="contoh: 23123456" pattern="^[0-9]{6,12}$" required />
            </div>
            <div>
              <label for="emailKampus">Email Kampus</label>
              <input
                id="emailKampus"
                name="email"
                type="email"
                placeholder="nama@polmed.ac.id"
                inputmode="email"
                autocomplete="email"
                required
              />
            </div>
            <div>
              <label for="programStudi">Program Studi</label>
              <select id="programStudi" name="prodi" required>
                <option value="">Pilih program studi</option>
                <option value="Teknik Informatika">Teknik Informatika</option>
                <option value="Teknik Komputer">Teknik Komputer</option>
                <option value="Akuntansi">Akuntansi</option>
                <option value="Administrasi Bisnis">Administrasi Bisnis</option>
                <option value="Pariwisata">Pariwisata</option>
              </select>
            </div>
            <div>
              <label for="alasan">Alasan Pengajuan</label>
              <textarea id="alasan" name="alasan" rows="4" placeholder="Tuliskan keperluan Anda..." required></textarea>
            </div>
            <div class="notice-card" style="margin-top: 16px; background: rgba(37, 99, 235, 0.05);">
              <p class="muted" style="margin: 0;">
                Dengan mengirim formulir ini, Anda menyetujui bahwa data akan digunakan untuk verifikasi keanggotaan perpustakaan.
              </p>
            </div>
            <button class="btn btn-primary" type="submit">Kirim Permohonan</button>
          </form>
        </section>

        <section class="card form-card" style="max-width: 640px;">
          <div class="notice-card" id="loginNumberResult" style="flex-direction: column; gap: 12px;">
            <div>
              <p class="notice-title" style="margin-bottom: 6px;">Status Nomor Login Anda</p>
              <p class="muted" data-result-description>
                Belum ada nomor login yang diterbitkan. Admin akan menghubungi Anda melalui email setelah permohonan disetujui.
              </p>
            </div>
            <div class="number-pill" data-result-number>-</div>
            <p class="muted" style="font-size: 0.85rem;">
              Jika sudah menerima nomor dari admin, buka halaman ini melalui tautan resmi (misal:
              <code>request-login.html?login=PNMED-00001</code>) untuk menampilkannya kembali.
            </p>
          </div>
        </section>
      </main>

      <footer>
        <div class="container">Â© 2025 Perpustakaan Politeknik Negeri Medan</div>
      </footer>
    </div>
    <script>
      (function () {
        const params = new URLSearchParams(window.location.search);
        const notice = document.querySelector('.notice-card');
        if (!notice) return;

        const resultNumber = document.querySelector('[data-result-number]');
        const resultDescription = document.querySelector('[data-result-description]');

        if (params.get('status') === 'success' && notice) {
          const success = document.createElement('p');
          success.className = 'notice-title';
          success.style.color = '#16a34a';
          success.textContent = 'Permohonan berhasil dikirim. Admin akan segera memproses nomor login Anda.';
          notice.prepend(success);
        }

        const loginNumber = params.get('login');
        if (loginNumber) {
          resultNumber.textContent = loginNumber.toUpperCase();
          resultDescription.textContent = 'Nomor login sudah diterbitkan. Gunakan kode berikut saat login.';
        } else {
          resultNumber.textContent = '-';
          resultDescription.textContent =
            'Belum ada nomor login yang diterbitkan. Admin akan menghubungi Anda melalui email setelah permohonan disetujui.';
        }
      })();
    </script>
  </body>
</html>

